## Лабораторная работа №2

исходный репозиторий https://github.com/docker/docker-nodejs-sample.git

редактируем файл postgres.js
регистрируемся, для того чтобы подучить права на загрузку образов в Container Registry
Идем по ссылке https://oauth.yandex.ru/authorize?response_type=token&client_id=1a6990aa636648e9b2ef855fa7bec2fb ,входим под своим пользователем. Копируем значение токена
вводим команду 
docker login --username oauth --password <ваш токен> cr.yandex 
 - мы зарегистрировались для загрузки в реестр

после этого строим образ  - в папке lab2/docker-nodejs-sample вводим команду
docker build -t todo-app-<ваша фамилия>:latest  .
после этого "переименовываем" образ:
docker tag todo-app-svistunov:latest cr.yandex/<узнайте идентификатор реестра у преподавателя>/todo-app-<ваша фамилия>:latest

после этого загружаем наш образ в реестр:
docker push cr.yandex/<узнайте идентификатор реестра у преподавателя>/todo-app-<ваша фамилия>:latest

после этого мы можем создавать контейнер
Идем в Serverless containers, создаем новый контейнер
имя контейнера - todo-app-<ваша фамилия>-container
vCPU: 1 (оставляем без изменений)
Гарантированная доля vCPU: 5%
RAM: 128МБ (оставляем без изменений)

URL образа: выбираем загруженный вами образ (его имя - ) todo-app-<ваша фамилия>
Тег - latest

Переменные окружения
POSTGRES_HOST: <спросите у преподавателя>
POSTGRES_PORT: 6432
NODE_ENV: production
POSTGRES_DB: db1
SECTION: <ваша фамилия>

Секреты Yandex Lockbox: 
POSTGRES_USER из секрета key_for_postres выбираем значение DBUSER
POSTGRES_PASSWORD из секрета key_for_postres выбираем значение DBPASSWORD

Сервисный аккаунт: image puller
Сеть: default

Все остальные параметры оставляем по умолчанию:
Количество одновременных вызовов экземпляра контейнера: 1
Количество подготовленных экземпляров: 0

После создания контейнера - публикуем его (нажимаем соответствующий переключатель)


Обратите внимание! Если вы внесли изменения, собрали новый образ и выложили его, вам нужно войти в контейнер и нажать кнопку "Создать ревизию", без этого изменения к контейнеру не будут применены.


